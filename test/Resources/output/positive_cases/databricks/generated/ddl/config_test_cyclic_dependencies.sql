CREATE WIDGET TEXT processing_date DEFAULT '';

-- COMMAND --

DROP TABLE IF EXISTS TEST.CYCLIC_DEPENDENCY_DIRECT_SRC;

CREATE TABLE TEST.CYCLIC_DEPENDENCY_DIRECT_SRC
(
	TGT_COL1 STRING,
	TGT_COL2 INTEGER
)

STORED AS PARQUET
LOCATION '/mnt/dct/chdp/test/cyclic_dependency_direct_src';

-- COMMAND --

DROP TABLE IF EXISTS TEST.CYCLIC_DEPENDENCY_DIRECT_TGT;

CREATE TABLE TEST.CYCLIC_DEPENDENCY_DIRECT_TGT
(
	TGT_COL1 STRING,
	TGT_COL2 INTEGER
)

STORED AS PARQUET
LOCATION '/mnt/dct/chdp/test/cyclic_dependency_direct_tgt';

-- COMMAND --

DROP TABLE IF EXISTS TEST.CYCLIC_DEPENDENCY_INDIRECT_1;

CREATE TABLE TEST.CYCLIC_DEPENDENCY_INDIRECT_1
(
	TGT_COL1 STRING,
	TGT_COL2 INTEGER
)

STORED AS PARQUET
LOCATION '/mnt/dct/chdp/test/cyclic_dependency_indirect_1';

-- COMMAND --

DROP TABLE IF EXISTS TEST.CYCLIC_DEPENDENCY_INDIRECT_2;

CREATE TABLE TEST.CYCLIC_DEPENDENCY_INDIRECT_2
(
	TGT_COL1 STRING,
	TGT_COL2 INTEGER
)

STORED AS PARQUET
LOCATION '/mnt/dct/chdp/test/cyclic_dependency_indirect_2';

-- COMMAND --

DROP TABLE IF EXISTS TEST.CYCLIC_DEPENDENCY_INDIRECT_3;

CREATE TABLE TEST.CYCLIC_DEPENDENCY_INDIRECT_3
(
	TGT_COL1 STRING,
	TGT_COL2 INTEGER
)

STORED AS PARQUET
LOCATION '/mnt/dct/chdp/test/cyclic_dependency_indirect_3';
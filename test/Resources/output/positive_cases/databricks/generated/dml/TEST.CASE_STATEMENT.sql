CREATE WIDGET TEXT processing_date DEFAULT '';

-- COMMAND --


-- COMMAND --

%run test sample

-- COMMAND --


-- COMMAND --

-- Below query is generated from : mapping_test_file_case_statement.csv
INSERT OVERWRITE TEST.CASE_STATEMENT
SELECT
	CASE SRC_TBL1.SRC_COL1
	WHEN '01' THEN 1
	ELSE 0
	END AS TGT_COL1,
	CASE SUBSTR(SRC_COL1, 6, 2)
	WHEN '01' THEN 1
	ELSE 0
	END AS TGT_COL2,
	SRC_TBL1.SRC_COL1 AS TGT_COL3,
	SRC_TBL1.SRC_COL1 AS TGT_COL4,
	CAST(SRC_TBL1.SRC_COL1 AS STRING) AS TGT_COL5
FROM SRC_DB1.SRC_TBL1;